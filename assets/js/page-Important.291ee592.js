(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{553:function(t,s,a){"use strict";a.r(s);var e=a(1),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"version"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#version"}},[t._v("#")]),t._v(" Version")]),t._v(" "),a("p",[a("code",[t._v("ShardingCore")]),t._v(" version is a.b.c.d")]),t._v(" "),a("ul",[a("li",[t._v("a:"),a("code",[t._v("EFCore")]),t._v(" version")]),t._v(" "),a("li",[t._v("b:"),a("code",[t._v("ShardingCore")]),t._v(" version")]),t._v(" "),a("li",[t._v("c:"),a("code",[t._v("ShardingCore")]),t._v(" second version")]),t._v(" "),a("li",[t._v("d:"),a("code",[t._v("ShardingCore")]),t._v(" fix version")])]),t._v(" "),a("h2",{attrs:{id:"common-problem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#common-problem"}},[t._v("#")]),t._v(" Common Problem")]),t._v(" "),a("p",[t._v("current dbcontext is virtual dbcontext not real execute dbcontext，real dbcontext is in DbContextExecutor")]),t._v(" "),a("h2",{attrs:{id:"dbcontext-constructor-problem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dbcontext-constructor-problem"}},[t._v("#")]),t._v(" DbContext Constructor Problem")]),t._v(" "),a("p",[t._v("dont use ant method that will created model before.")]),t._v(" "),a("div",{staticClass:"language-c# line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("        public DefaultShardingDbContext(DbContextOptions<DefaultShardingDbContext> options) : base(options)\n        {\n            //dont invoke\n            //ChangeTracker.QueryTrackingBehavior = QueryTrackingBehavior.NoTracking;\n            //Database.SetCommandTimeout(30000);\n        }\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("h2",{attrs:{id:"performance-loss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#performance-loss"}},[t._v("#")]),t._v(" Performance loss")]),t._v(" "),a("p",[t._v("query no sharding entity,"),a("code",[t._v("ShardingCore")]),t._v(" slow than "),a("code",[t._v("EFCore")]),t._v(" 0.005ms single query;")]),t._v(" "),a("h2",{attrs:{id:"disadvantage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#disadvantage"}},[t._v("#")]),t._v(" Disadvantage")]),t._v(" "),a("ul",[a("li",[t._v("use more conection in single query，but u can limit with start up options:"),a("code",[t._v("MaxQueryConnectionsLimit")])]),t._v(" "),a("li",[t._v("sharding entity not support include,if u want join two entities u can use join.")]),t._v(" "),a("li",[t._v("sharding entity dont set nav properties like icollection or list")])]),t._v(" "),a("h2",{attrs:{id:"gethashcode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gethashcode"}},[t._v("#")]),t._v(" GetHashCode")]),t._v(" "),a("p",[t._v("c# "),a("code",[t._v("GetHashCode")])]),t._v(" "),a("p",[t._v("When we do not modify the object, we call hashcode many times to return the same integer. In the same application, if we execute it many times, the integer returned by each execution may be inconsistent\nsuggestion use "),a("code",[t._v("sharding-core")]),t._v(" provider method "),a("code",[t._v("ShardingCoreHelper.GetStringHashCode(shardingKeyStr)")])]),t._v(" "),a("h2",{attrs:{id:"group-by"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#group-by"}},[t._v("#")]),t._v(" Group By")]),t._v(" "),a("p",[t._v("if use "),a("code",[t._v("group by")]),t._v(" queryable will append order by while order by item is empty,if has order by item shoule use full select properties")]),t._v(" "),a("h2",{attrs:{id:"guid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#guid"}},[t._v("#")]),t._v(" GUID")]),t._v(" "),a("p",[t._v("c# guid compare is difference with sqlserver uniqueidentifier，"),a("code",[t._v("sharding-core")]),t._v(" is fix this bug,use SqlGuid to compare,but not fix "),a("code",[t._v("Nullable<Guid>")]),t._v(" if u want fix it. example:")]),t._v(" "),a("div",{staticClass:"language-csharp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// <summary>")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// like this example")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// </summary>")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/// <typeparam name="TShardingDbContext"></typeparam>')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SqlServerNullableGuidCSharpLanguageShardingComparer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("TShardingDbContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token type-list"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CSharpLanguageShardingComparer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("TShardingDbContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TShardingDbContext")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token type-list"}},[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DbContext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IShardingDbContext")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Compare")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IComparable")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IComparable")]),t._v(" y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")])]),t._v(" asc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XXType")]),t._v(" xg "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" y "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XXType")]),t._v(" yg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("XXFixedType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SafeCompareToWith")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("XXFixedType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("yg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" asc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("base")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Compare")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" asc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//configure")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ReplaceShardingComparer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("SqlServerNullableGuidCSharpLanguageShardingComparer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("DefaultShardingDbContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("p",[a("strong",[t._v("注意:fix c# compare guid")])]),t._v(" "),a("h2",{attrs:{id:"auto-increment-field"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#auto-increment-field"}},[t._v("#")]),t._v(" auto increment field")]),t._v(" "),a("p",[t._v("do not configure auto increment field in "),a("code",[t._v("sharding-core")]),t._v(" sharding field。e.g:increment id")]),t._v(" "),a("h2",{attrs:{id:"ensurecreated"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ensurecreated"}},[t._v("#")]),t._v(" EnsureCreated")]),t._v(" "),a("p",[a("code",[t._v("DbContext.Database.EnsureCreated()")]),t._v(" if u want use this method ,plz impl "),a("code",[t._v("IMigrationsSqlGenerator")])]),t._v(" "),a("h2",{attrs:{id:"sharding-with-time"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sharding-with-time"}},[t._v("#")]),t._v(" sharding with time")]),t._v(" "),a("p",[t._v("if u use sharding with time field,plz read"),a("a",{attrs:{href:"/sharding-core-doc/en/adv/pagination"}},[t._v("pagination")])])])}),[],!1,null,null,null);s.default=n.exports}}]);